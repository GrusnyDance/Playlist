## Плейлист
Программа реализована как GRPC сервер + клиент. На клиенте можно вызвать следующие функции:
 - AddSong - клиент передает произвольный текстовый запрос, после чего на сервере вызывается api ютуба и выбирается одно видео по запросу (запоминаем ссылку). Ссылку передаем в другое api (Viveoz), которое умеет генерировать из видео mp3 файл и дает ссылку на скачивание аудио. Аудио скачивается на жесткий диск (локальную машину, сервер).
 - Play - сервер передает стрим байтов из файла, на котором стоит текущий курсор в плейлисте (плейлист реализован как двусвязный список). На клиенте вызывается функция которая декодирует стрим в звук. Программа рассчитана на реальное воспроизведение аудио.
 - Pause - передача стрима останавливается на сервере, и звук на клиенте тоже прекращается.
 - Delete - если удаляется песня которая проигрывается, сначала плеер останавливается.
 - Next - перейти к следующей песне (пока не прожат play, звук не пойдет)
 - Prev - перейти к предыдущей песне
 
 ### Конфиги
 Плейлист обеспечивает сохранение настроек и данных после перезапуска. Файлы с песнями хранятся на локальной машине, названия и длительность песен хранятся в базе (когда сервер стартует, содержимое базы переписывается в заданном порядке в двусвязный список). Также для песен хранятся оффсеты, которые запоминают на каком байте закончилось воспроизведение.
 
 Чтобы вызывать функции сохранения конфигураций реализован graceful shutdown.
 
 ### Запуск
 На линуксе можно попробовать запустить программу. Скачайте `libasound2-dev`, а также создайте базу данных в postgres с настройками как в файле server/internal/storage/config.yaml. Попробуйте запустить:
 ```
 go run client/cmd/main.go
 
 go run server/cmd/main.go
 ```
 
 В результате должна заиграть песня Валерия Меладзе (лежит в репозитории) в соответствии с юзкейсом в файле client/usecase/usecase.go: воспроизведение, пауза, удаление. На момент последнего тестирования функция добавления песен отвалилась из за ограничений на количество скачиваний в api ютуба + ошибок api viveoz. Попробуйте раскомментировать эту функцию и посмотреть как асинхронно скачиваются 5 песен. Чтобы избежать race condition при добавлении в плейлист-двусвязный список используются мьютексы. 
 
### Докер
На данный момент не удалось обеспечить успешный запуск программы в докере. В ветке `docker` можно посмотреть реализацию сборки в трех контейнерах (клиент, сервер, база). К сожалению, вызов плеера в контейнере не синхронизируется с динамиками хоста и вызывает ошибки. Вероятно клиент может работать только на локальном устройстве. 


\*Думаю текущий проект - самое интересное что мне приходилось делать)
